<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>scran_normalize_counts: scran::center_size_factors Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">scran_normalize_counts
   </div>
   <div id="projectbrief">Normalize and log-transform counts</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescran.html">scran</a></li><li class="navelem"><a class="el" href="namespacescran_1_1center__size__factors.html">center_size_factors</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">scran::center_size_factors Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Center size factors prior to scaling normalization.  
<a href="namespacescran_1_1center__size__factors.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1center__size__factors_1_1Options.html">Options</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structscran_1_1center__size__factors_1_1Options.html" title="Options for compute() and compute_blocked().">Options</a> for <code><a class="el" href="namespacescran_1_1center__size__factors.html#a6c791f5cf852c4901e510e90af0d3744">compute()</a></code> and <code><a class="el" href="namespacescran_1_1center__size__factors.html#a38aec96b210a32eb97ae5c0f47fe861c">compute_blocked()</a></code>.  <a href="structscran_1_1center__size__factors_1_1Options.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a7734640d4844a6a52efef03cc52d093f" id="r_a7734640d4844a6a52efef03cc52d093f"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescran_1_1center__size__factors.html#a7734640d4844a6a52efef03cc52d093f">BlockMode</a> : char { <b>PER_BLOCK</b>
, <b>LOWEST</b>
 }</td></tr>
<tr class="separator:a7734640d4844a6a52efef03cc52d093f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4c4cfc7fe1262a4cdd27f1e845bb4579" id="r_a4c4cfc7fe1262a4cdd27f1e845bb4579"><td class="memTemplParams" colspan="2">template&lt;typename SizeFactor_ &gt; </td></tr>
<tr class="memitem:a4c4cfc7fe1262a4cdd27f1e845bb4579"><td class="memTemplItemLeft" align="right" valign="top">SizeFactor_&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1center__size__factors.html#a4c4cfc7fe1262a4cdd27f1e845bb4579">compute_mean</a> (size_t num, const SizeFactor_ *size_factors, <a class="el" href="structscran_1_1sanitize__size__factors_1_1Diagnostics.html">sanitize_size_factors::Diagnostics</a> *diagnostics, const <a class="el" href="structscran_1_1center__size__factors_1_1Options.html">Options</a> &amp;options)</td></tr>
<tr class="separator:a4c4cfc7fe1262a4cdd27f1e845bb4579"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c791f5cf852c4901e510e90af0d3744" id="r_a6c791f5cf852c4901e510e90af0d3744"><td class="memTemplParams" colspan="2">template&lt;typename SizeFactor_ &gt; </td></tr>
<tr class="memitem:a6c791f5cf852c4901e510e90af0d3744"><td class="memTemplItemLeft" align="right" valign="top">SizeFactor_&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1center__size__factors.html#a6c791f5cf852c4901e510e90af0d3744">compute</a> (size_t num, SizeFactor_ *size_factors, <a class="el" href="structscran_1_1sanitize__size__factors_1_1Diagnostics.html">sanitize_size_factors::Diagnostics</a> *diagnostics, const <a class="el" href="structscran_1_1center__size__factors_1_1Options.html">Options</a> &amp;options)</td></tr>
<tr class="separator:a6c791f5cf852c4901e510e90af0d3744"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac30020480ad8d32c883603db60a6a2d0" id="r_ac30020480ad8d32c883603db60a6a2d0"><td class="memTemplParams" colspan="2">template&lt;typename SizeFactor_ , typename Block_ &gt; </td></tr>
<tr class="memitem:ac30020480ad8d32c883603db60a6a2d0"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; SizeFactor_ &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1center__size__factors.html#ac30020480ad8d32c883603db60a6a2d0">compute_blocked_mean</a> (size_t num, const SizeFactor_ *size_factors, const Block_ *block, <a class="el" href="structscran_1_1sanitize__size__factors_1_1Diagnostics.html">sanitize_size_factors::Diagnostics</a> *diagnostics, const <a class="el" href="structscran_1_1center__size__factors_1_1Options.html">Options</a> &amp;options)</td></tr>
<tr class="separator:ac30020480ad8d32c883603db60a6a2d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38aec96b210a32eb97ae5c0f47fe861c" id="r_a38aec96b210a32eb97ae5c0f47fe861c"><td class="memTemplParams" colspan="2">template&lt;typename SizeFactor_ , typename Block_ &gt; </td></tr>
<tr class="memitem:a38aec96b210a32eb97ae5c0f47fe861c"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; SizeFactor_ &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1center__size__factors.html#a38aec96b210a32eb97ae5c0f47fe861c">compute_blocked</a> (size_t num, SizeFactor_ *size_factors, const Block_ *block, <a class="el" href="structscran_1_1sanitize__size__factors_1_1Diagnostics.html">sanitize_size_factors::Diagnostics</a> *diagnostics, const <a class="el" href="structscran_1_1center__size__factors_1_1Options.html">Options</a> &amp;options)</td></tr>
<tr class="separator:a38aec96b210a32eb97ae5c0f47fe861c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Center size factors prior to scaling normalization. </p>
<p>Centering involves scaling all size factors so that their mean is equal to 1. The aim is to ensure that the normalized expression values are on roughly the same scale as the original counts. This simplifies interpretation and ensures that any added pseudo-count prior to log-transformation has a predictable shrinkage effect. In general, size factors should be centered before calling <code>log_normalize_counts::compute()</code>.</p>
<p>For datasets with multiple blocks, <code><a class="el" href="namespacescran_1_1center__size__factors.html#a38aec96b210a32eb97ae5c0f47fe861c">compute_blocked()</a></code> will compute the center separately for each block. The strategy for centering across blocks is determined by <code><a class="el" href="structscran_1_1center__size__factors_1_1Options.html#af7ee388030c9fc90893ef00926f7025a">Options::block_mode</a></code>. </p>
</div><h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a7734640d4844a6a52efef03cc52d093f" name="a7734640d4844a6a52efef03cc52d093f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7734640d4844a6a52efef03cc52d093f">&#9670;&#160;</a></span>BlockMode</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum class <a class="el" href="namespacescran_1_1center__size__factors.html#a7734640d4844a6a52efef03cc52d093f">scran::center_size_factors::BlockMode</a> : char</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Strategy for handling blocks, see <code><a class="el" href="structscran_1_1center__size__factors_1_1Options.html#af7ee388030c9fc90893ef00926f7025a">Options::block_mode</a></code> for details. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a4c4cfc7fe1262a4cdd27f1e845bb4579" name="a4c4cfc7fe1262a4cdd27f1e845bb4579"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c4cfc7fe1262a4cdd27f1e845bb4579">&#9670;&#160;</a></span>compute_mean()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename SizeFactor_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">SizeFactor_ scran::center_size_factors::compute_mean </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SizeFactor_ *&#160;</td>
          <td class="paramname"><em>size_factors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structscran_1_1sanitize__size__factors_1_1Diagnostics.html">sanitize_size_factors::Diagnostics</a> *&#160;</td>
          <td class="paramname"><em>diagnostics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1center__size__factors_1_1Options.html">Options</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">SizeFactor_</td><td>Floating-point type for the size factors.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of cells. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size_factors</td><td>Pointer to an array of length <code>num</code>, containing the size factor for each cell. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">diagnostics</td><td>Diagnostics for invalid size factors. This is only used if <code><a class="el" href="structscran_1_1center__size__factors_1_1Options.html#a8eafa0dfb239ea3d0a5988ec36176dd6">Options::ignore_invalid</a> = true</code>, in which case it is filled with invalid diagnostics for values in <code>size_factors</code>. It can also be NULL, in which case it is ignored. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The mean size factor. </dd></dl>

</div>
</div>
<a id="a6c791f5cf852c4901e510e90af0d3744" name="a6c791f5cf852c4901e510e90af0d3744"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c791f5cf852c4901e510e90af0d3744">&#9670;&#160;</a></span>compute()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename SizeFactor_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">SizeFactor_ scran::center_size_factors::compute </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SizeFactor_ *&#160;</td>
          <td class="paramname"><em>size_factors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structscran_1_1sanitize__size__factors_1_1Diagnostics.html">sanitize_size_factors::Diagnostics</a> *&#160;</td>
          <td class="paramname"><em>diagnostics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1center__size__factors_1_1Options.html">Options</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">SizeFactor_</td><td>Floating-point type for the size factors.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of cells. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">size_factors</td><td>Pointer to an array of length <code>num</code>, containing the size factor for each cell. On output, this contains centered size factors. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">diagnostics</td><td>Diagnostics for invalid size factors. This is only used if <code><a class="el" href="structscran_1_1center__size__factors_1_1Options.html#a8eafa0dfb239ea3d0a5988ec36176dd6">Options::ignore_invalid</a> = true</code>, in which case it is filled with invalid diagnostics for values in <code>size_factors</code>. It can also be NULL, in which case it is ignored. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The mean size factor. </dd></dl>

</div>
</div>
<a id="ac30020480ad8d32c883603db60a6a2d0" name="ac30020480ad8d32c883603db60a6a2d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac30020480ad8d32c883603db60a6a2d0">&#9670;&#160;</a></span>compute_blocked_mean()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename SizeFactor_ , typename Block_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; SizeFactor_ &gt; scran::center_size_factors::compute_blocked_mean </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SizeFactor_ *&#160;</td>
          <td class="paramname"><em>size_factors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Block_ *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structscran_1_1sanitize__size__factors_1_1Diagnostics.html">sanitize_size_factors::Diagnostics</a> *&#160;</td>
          <td class="paramname"><em>diagnostics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1center__size__factors_1_1Options.html">Options</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">SizeFactor_</td><td>Floating-point type for the size factors. </td></tr>
    <tr><td class="paramname">Block_</td><td>Integer type for the block assignments.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of cells. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size_factors</td><td>Pointer to an array of length <code>num</code>, containing the size factor for each cell. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Pointer to an array of length <code>num</code>, containing the block assignment for each cell. Each assignment should be an integer in <picture><source srcset="form_0_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$[0, N)$" src="form_0.png"/></picture> where <picture><source srcset="form_1_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$N$" src="form_1.png"/></picture> is the total number of blocks. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">diagnostics</td><td>Diagnostics for invalid size factors. This is only used if <code><a class="el" href="structscran_1_1center__size__factors_1_1Options.html#a8eafa0dfb239ea3d0a5988ec36176dd6">Options::ignore_invalid</a> = true</code>, in which case it is filled with invalid diagnostics for values in <code>size_factors</code>. It can also be NULL, in which case it is ignored. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector of length <picture><source srcset="form_1_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$N$" src="form_1.png"/></picture> containing the mean size factor for each block. </dd></dl>

</div>
</div>
<a id="a38aec96b210a32eb97ae5c0f47fe861c" name="a38aec96b210a32eb97ae5c0f47fe861c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38aec96b210a32eb97ae5c0f47fe861c">&#9670;&#160;</a></span>compute_blocked()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename SizeFactor_ , typename Block_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; SizeFactor_ &gt; scran::center_size_factors::compute_blocked </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SizeFactor_ *&#160;</td>
          <td class="paramname"><em>size_factors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Block_ *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structscran_1_1sanitize__size__factors_1_1Diagnostics.html">sanitize_size_factors::Diagnostics</a> *&#160;</td>
          <td class="paramname"><em>diagnostics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1center__size__factors_1_1Options.html">Options</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">SizeFactor_</td><td>Floating-point type for the size factors. </td></tr>
    <tr><td class="paramname">Block_</td><td>Integer type for the block assignments.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of cells. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size_factors</td><td>Pointer to an array of length <code>num</code>, containing the size factor for each cell. On output, this contains size factors that are centered according to <code><a class="el" href="structscran_1_1center__size__factors_1_1Options.html#af7ee388030c9fc90893ef00926f7025a">Options::block_mode</a></code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Pointer to an array of length <code>num</code>, containing the block assignment for each cell. Each assignment should be an integer in <picture><source srcset="form_0_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$[0, N)$" src="form_0.png"/></picture> where <picture><source srcset="form_1_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$N$" src="form_1.png"/></picture> is the total number of blocks. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">diagnostics</td><td>Diagnostics for invalid size factors. This is only used if <code><a class="el" href="structscran_1_1center__size__factors_1_1Options.html#a8eafa0dfb239ea3d0a5988ec36176dd6">Options::ignore_invalid</a> = true</code>, in which case it is filled with invalid diagnostics for values in <code>size_factors</code>. It can also be NULL, in which case it is ignored. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector of length <picture><source srcset="form_1_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$N$" src="form_1.png"/></picture> containing the mean size factor for each block. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
