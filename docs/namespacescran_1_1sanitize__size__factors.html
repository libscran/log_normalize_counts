<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>scran_log_normalize_counts: scran::sanitize_size_factors Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">scran_log_normalize_counts
   </div>
   <div id="projectbrief">Normalize and log-transform counts</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescran.html">scran</a></li><li class="navelem"><a class="el" href="namespacescran_1_1sanitize__size__factors.html">sanitize_size_factors</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">scran::sanitize_size_factors Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Sanitize invalid size factors.  
<a href="namespacescran_1_1sanitize__size__factors.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1sanitize__size__factors_1_1Diagnostics.html">Diagnostics</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validity of size factors.  <a href="structscran_1_1sanitize__size__factors_1_1Diagnostics.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1sanitize__size__factors_1_1Options.html">Options</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default parameters.  <a href="structscran_1_1sanitize__size__factors_1_1Options.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a1e9687d1cbc47f51e5032df413c97010" id="r_a1e9687d1cbc47f51e5032df413c97010"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescran_1_1sanitize__size__factors.html#a1e9687d1cbc47f51e5032df413c97010">HandleAction</a> : char { <b>IGNORE</b>
, <b>ERROR</b>
, <b>SANITIZE</b>
 }</td></tr>
<tr class="separator:a1e9687d1cbc47f51e5032df413c97010"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad2c84e0a75a630c3f7f54edd009e2431" id="r_ad2c84e0a75a630c3f7f54edd009e2431"><td class="memTemplParams" colspan="2">template&lt;typename SizeFactor_ &gt; </td></tr>
<tr class="memitem:ad2c84e0a75a630c3f7f54edd009e2431"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran_1_1sanitize__size__factors_1_1Diagnostics.html">Diagnostics</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1sanitize__size__factors.html#ad2c84e0a75a630c3f7f54edd009e2431">check</a> (size_t num, const SizeFactor_ *size_factors)</td></tr>
<tr class="separator:ad2c84e0a75a630c3f7f54edd009e2431"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aed65fe52d5abe25550519137805be7" id="r_a5aed65fe52d5abe25550519137805be7"><td class="memTemplParams" colspan="2">template&lt;typename SizeFactor_ &gt; </td></tr>
<tr class="memitem:a5aed65fe52d5abe25550519137805be7"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1sanitize__size__factors.html#a5aed65fe52d5abe25550519137805be7">compute</a> (size_t num, SizeFactor_ *size_factors, const <a class="el" href="structscran_1_1sanitize__size__factors_1_1Diagnostics.html">Diagnostics</a> &amp;status, const <a class="el" href="structscran_1_1sanitize__size__factors_1_1Options.html">Options</a> &amp;options)</td></tr>
<tr class="separator:a5aed65fe52d5abe25550519137805be7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad452d11b0bfd9cdc50f47a0d13ccece" id="r_aad452d11b0bfd9cdc50f47a0d13ccece"><td class="memTemplParams" colspan="2">template&lt;typename SizeFactor_ &gt; </td></tr>
<tr class="memitem:aad452d11b0bfd9cdc50f47a0d13ccece"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran_1_1sanitize__size__factors_1_1Diagnostics.html">Diagnostics</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1sanitize__size__factors.html#aad452d11b0bfd9cdc50f47a0d13ccece">compute</a> (size_t num, SizeFactor_ *size_factors, const <a class="el" href="structscran_1_1sanitize__size__factors_1_1Options.html">Options</a> &amp;options)</td></tr>
<tr class="separator:aad452d11b0bfd9cdc50f47a0d13ccece"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Sanitize invalid size factors. </p>
<p>Replace zero, missing or infinite values in the size factor array so that it can be used to compute well-defined normalized values. Such size factors can occasionally arise if, e.g., insufficient quality control was performed upstream. Check out the documentation in <code><a class="el" href="structscran_1_1sanitize__size__factors_1_1Options.html" title="Default parameters.">Options</a></code> to see what placeholder value is used for each type of invalid size factor.</p>
<p>In general, sanitization should occur after calls to <code><a class="el" href="namespacescran_1_1center__size__factors.html#a6c791f5cf852c4901e510e90af0d3744">center_size_factors::compute()</a></code>, <code><a class="el" href="namespacescran_1_1choose__pseudo__count.html#a1ba10a0f95a1ba240b742bb201acb1bf">choose_pseudo_count::compute()</a></code>, or any function that computes a statistic based on the distribution of size factors. This ensures that the results of those functions are not affected by the placeholder values used to replace the invalid size factors. As a rule of thumb, <code><a class="el" href="namespacescran_1_1sanitize__size__factors.html#a5aed65fe52d5abe25550519137805be7">sanitize_size_factors::compute()</a></code> should be called just before passing those size factors to <code>log_normalize_counts::compute()</code>. </p>
</div><h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a1e9687d1cbc47f51e5032df413c97010" name="a1e9687d1cbc47f51e5032df413c97010"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e9687d1cbc47f51e5032df413c97010">&#9670;&#160;</a></span>HandleAction</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum class <a class="el" href="namespacescran_1_1sanitize__size__factors.html#a1e9687d1cbc47f51e5032df413c97010">scran::sanitize_size_factors::HandleAction</a> : char</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>How invalid size factors should be handled:</p>
<ul>
<li><code>IGNORE</code>: ignore invalid size factors with no error or change.</li>
<li><code>ERROR</code>: throw an error.</li>
<li><code>SANITIZE</code>: fix each invalid size factor. </li>
</ul>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ad2c84e0a75a630c3f7f54edd009e2431" name="ad2c84e0a75a630c3f7f54edd009e2431"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2c84e0a75a630c3f7f54edd009e2431">&#9670;&#160;</a></span>check()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename SizeFactor_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran_1_1sanitize__size__factors_1_1Diagnostics.html">Diagnostics</a> scran::sanitize_size_factors::check </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SizeFactor_ *&#160;</td>
          <td class="paramname"><em>size_factors</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check whether there are any invalid size factors. Size factors are only technically valid if they are finite and positive.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">SizeFactor_</td><td>Floating-point type for the size factors.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of size factors. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size_factors</td><td>Pointer to an array of size factors of length <code>num</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Validation results, indicating whether any zero or non-finite size factors exist. </dd></dl>

</div>
</div>
<a id="a5aed65fe52d5abe25550519137805be7" name="a5aed65fe52d5abe25550519137805be7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5aed65fe52d5abe25550519137805be7">&#9670;&#160;</a></span>compute() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename SizeFactor_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void scran::sanitize_size_factors::compute </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SizeFactor_ *&#160;</td>
          <td class="paramname"><em>size_factors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1sanitize__size__factors_1_1Diagnostics.html">Diagnostics</a> &amp;&#160;</td>
          <td class="paramname"><em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1sanitize__size__factors_1_1Options.html">Options</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">SizeFactor_</td><td>Floating-point type for the size factors.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of size factors. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">size_factors</td><td>Pointer to an array of positive size factors of length <code>n</code>. On output, invalid size factors are replaced. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">status</td><td>A pre-computed object indicating whether invalid size factors are present in <code>size_factors</code>. This can be useful if this information is already provided by, e.g., <code><a class="el" href="namespacescran_1_1sanitize__size__factors.html#ad2c84e0a75a630c3f7f54edd009e2431">check()</a></code> or <code><a class="el" href="namespacescran_1_1center__size__factors.html#a6c791f5cf852c4901e510e90af0d3744">center_size_factors::compute()</a></code>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aad452d11b0bfd9cdc50f47a0d13ccece" name="aad452d11b0bfd9cdc50f47a0d13ccece"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad452d11b0bfd9cdc50f47a0d13ccece">&#9670;&#160;</a></span>compute() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename SizeFactor_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran_1_1sanitize__size__factors_1_1Diagnostics.html">Diagnostics</a> scran::sanitize_size_factors::compute </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SizeFactor_ *&#160;</td>
          <td class="paramname"><em>size_factors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1sanitize__size__factors_1_1Options.html">Options</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">SizeFactor_</td><td>Floating-point type for the size factors.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of size factors. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">size_factors</td><td>Pointer to an array of positive size factors of length <code>n</code>. On output, invalid size factors are replaced. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An object whether each type of invalid size factors is present in <code>size_factors</code>. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
